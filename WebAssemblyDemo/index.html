<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>

<body>

    <!-- Create the canvas that the C++ code will draw into -->
    <div>lib80GFX demo screen (C++ / WebAssembly):</div>
    <div>
        <canvas id="canvas" oncontextmenu="event.preventDefault()" style="display:block; margin:auto; width:75%;"></canvas>
    </div>

    <!-- Create a textarea that the C++ code will 'stdout' into -->
    <div>C++ STDOUT output appears here:</div>
    <div>
        <textarea id="output" rows="8" style="width:100%"></textarea>
    </div>

    <!-- Allow the C++ to access the canvas element --> 
    <script type='text/javascript'>
        var Module = {
            print: (function() {
              var element = document.getElementById('output');
              if (element) element.value = ''; // clear browser cache
              return function(text) {
                if (arguments.length > 1) text = Array.prototype.slice.call(arguments).join(' ');
                // These replacements are necessary if you render to raw HTML
                //text = text.replace(/&/g, "&amp;");
                //text = text.replace(/</g, "&lt;");
                //text = text.replace(/>/g, "&gt;");
                //text = text.replace('\n', '<br>', 'g');
                console.log(text);
                if (element) {
                  element.value += text + "\n";
                  element.scrollTop = element.scrollHeight; // focus on bottom
                }
              };
            })(),
            printErr: function(text) {
              if (arguments.length > 1) text = Array.prototype.slice.call(arguments).join(' ');
              if (0) { // XXX disabled for safety typeof dump == 'function') {
                dump(text + '\n'); // fast, straight to the real console
              } else {
                console.error(text);
              }
            },
            canvas: (function() { return document.getElementById('canvas'); })()
        };
    </script>
    
    <!-- Add the javascript glue code (index.js) as generated by Emscripten -->
    <script src="index.js"></script>
    
    <p>Minimal example of animating the HTML5 canvas from C++ using SDL through WebAssembly.</p>
    <p>Source code: <a href="https://github.com/timhutton/sdl-canvas-wasm">https://github.com/timhutton/sdl-canvas-wasm</a></p>

</body>

</html>
